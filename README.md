# Project03_46W38
this is a submission of project 03

# Project03_46W38 – Wind Resource Assessment Based on ERA5

This repository contains my final project for **46W38 – Scientific Programming for Wind Energy (DTU)**.

The goal is to develop a **Python module** for wind resource assessment at a specified site using **ERA5** reanalysis data. The module reads multi-year hourly wind data at 10 m and 100 m, interpolates it to the **Horns Rev 1** site, and provides tools to:

- compute wind speed and direction time series  
- extrapolate wind to arbitrary heights using a power-law shear model  
- fit Weibull distributions  
- plot wind speed distributions and wind roses  
- compute Annual Energy Production (AEP) for selected turbines (NREL 5 MW and NREL 15 MW)

The code is organized as a module inside `src/` with at least one class (`WindResource`) as required.

---

## Repository structure

```text
Project03_46W38/
├── inputs/
│   ├── 1997-1999.nc
│   ├── 2000-2002.nc
│   ├── 2003-2005.nc
│   ├── 2006-2008.nc
│   ├── NREL_Reference_5MW_126.csv
│   └── NREL_Reference_15MW_240.csv
├── outputs/
│   ├── weibull_100m_horns_rev.png        # generated by examples/main.py
│   └── wind_rose_100m_horns_rev.png      # generated by examples/main.py
├── src/
│   └── wind_assess/
│       ├── __init__.py
│       ├── core.py
│       └── utils.py
├── examples/
│   └── main.py
├── tests/
│   └── ... (pytest test files)
├── .gitignore
├── LICENSE
└── README.md

inputs/ – Provided ERA5 NetCDF4 files and turbine power curve CSVs.
outputs/ – Figures and other results generated by the example script.
src/wind_assess/ – The actual Python module (code to be imported).
examples/ – Example script showing how to use the module.
tests/ – Unit tests for the module (pytest).

Module architecture

The main logic lives in the wind_assess module:

graph TD
    A[examples/main.py] --> B[wind_assess.core.WindResource]
    A --> C[wind_assess.utils]

    B --> D[ERA5 NetCDF files<br/>inputs/1997-1999.nc ...]
    B --> E[Power curve CSVs<br/>NREL_5MW, NREL_15MW]
    B --> F[outputs/ plots & AEP results]

Files and classes
src/wind_assess/core.py

Defines the main class:

class WindResource:
    ds: xarray.Dataset


Key responsibilities of WindResource:

Data loading

from_files(filepaths)
Loads and concatenates multiple ERA5 NetCDF files into a single xarray.Dataset.

Wind speed & direction

get_speed_direction_at_point(lat, lon, height, start_year=1997, end_year=2008)

Interpolates u/v components to a given point inside the 2×2 ERA5 grid.

Computes hourly wind speed and direction (meteorological convention).

Wind shear & extrapolation

estimate_alpha_at_point(lat, lon, start_year, end_year)
Estimates the power-law exponent α using 10 m and 100 m speeds.

extrapolate_speed_power_law(lat, lon, z_target, z_ref, alpha, start_year, end_year)
Extrapolates wind speed from 10 m or 100 m to an arbitrary height using

Weibull fitting

fit_weibull_1d(speeds)
Fits a Weibull distribution (shape k, scale A) using maximum likelihood.

fit_weibull_at_point(lat, lon, height, start_year, end_year, use_power_law=False)
Gets a time series at the given height (using ERA5 directly or power law) and returns fitted k and A.

AEP calculation

compute_aep_from_power_curve(lat, lon, hub_height, speed_bins, power_kw, year, availability)

Extrapolates wind to the hub height.

Interpolates the turbine power curve.

Assumes hourly data and integrates over the year to obtain AEP in MWh.

src/wind_assess/utils.py

Helper functions:

load_power_curve_csv(path)
Reads power curve CSVs (NREL 5 MW, NREL 15 MW) and returns:

speed_bins [m/s]

power_kw [kW]

plot_weibull_fit(speeds, k, A, ax=None)
Plots a histogram of wind speeds and the fitted Weibull PDF.

plot_wind_rose(directions_deg, ax=None, n_sectors=16)
Produces a simple wind rose using a polar histogram of wind directions.

src/wind_assess/__init__.py

Simple convenience import:

from .core import WindResource

__all__ = ["WindResource"]


This allows:

from wind_assess import WindResource

Functional coverage vs assignment requirements

The module implements the required functionality:

Load and parse multiple netCDF4 files

WindResource.from_files([...])

Compute wind speed and wind direction from u/v

Internal method _speed_dir_from_uv, used by get_speed_direction_at_point.

Compute time series at 10 m and 100 m for a given location inside the box

get_speed_direction_at_point(lat, lon, height=10/100, start_year, end_year)

Compute wind speed time series at any height z using power law

extrapolate_speed_power_law(...)

Fit Weibull distribution at a given location and height

fit_weibull_at_point(...) / fit_weibull_1d(...)

Plot wind speed distribution vs fitted Weibull

utils.plot_weibull_fit(...)

Used in examples/main.py

Plot wind rose

utils.plot_wind_rose(...)

Used in examples/main.py

Compute AEP of specified turbine at location for a given year

compute_aep_from_power_curve(...)

Used with NREL 5 MW (hub 90 m) and NREL 15 MW (hub 150 m).

How to run the example script
1. Requirements

Tested with:

Python 3.10+

Packages:

numpy

xarray

pandas

scipy

matplotlib

Install (one option):

pip install numpy xarray pandas scipy matplotlib

2. Ensure data files are in inputs/

Place the provided files as:

inputs/
├── 1997-1999.nc
├── 2000-2002.nc
├── 2003-2005.nc
├── 2006-2008.nc
├── NREL_Reference_5MW_126.csv
└── NREL_Reference_15MW_240.csv

3. Run from the project root

From the project root (the folder that contains src/ and examples/):

python -m examples.main


The script will:

Load ERA5 data from 1997–2008

Interpolate to Horns Rev 1

Latitude = 55.5297

Longitude = 7.9061

Compute 100 m speed and direction

Fit a Weibull distribution at 100 m

Plot:

outputs/weibull_100m_horns_rev.png

outputs/wind_rose_100m_horns_rev.png

Compute AEP (example year: 2005) for:

NREL 5 MW (hub 90 m)

NREL 15 MW (hub 150 m)

Example terminal output:

100m speed mean [m/s]: 9.57
100m direction mean [deg]: 208.56
Weibull at 100m: k=2.27, A=10.80 m/s
AEP 2005 - NREL 5MW @ Horns Rev:  24956.1 MWh
AEP 2005 - NREL 15MW @ Horns Rev: 81954.6 MWh
